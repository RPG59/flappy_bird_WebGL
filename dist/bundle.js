!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=9)}([function(t,e,r){"use strict";e.__esModule=!0,e.GL=null,e.DISPLAY_WIDTH=10,e.DISPLAY_HEIGHT=9/16*e.DISPLAY_WIDTH,e.initWebGL=function(){var t=document.querySelector("#glCanvas");try{e.GL=t.getContext("webgl2")}catch(t){console.error("WebGL is not ok!")}};var n=function(){return function(){}}();e.IGameObject=n},function(t,e,r){"use strict";e.__esModule=!0;var n=function(){return function(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.z=r}}();e.float3=n;var i=function(){function t(){this.elements=new Float32Array(16),this.identity()}return t.prototype.identity=function(){for(var t=0;t<16;++t)this.elements[t]=0;return this.elements[0]=1,this.elements[5]=1,this.elements[10]=1,this.elements[15]=1,this},t.prototype.translate=function(t){return this.elements[12]=t.x,this.elements[13]=t.y,this.elements[14]=t.z,this},t.prototype.rotate=function(t){var e=Math.PI*t/180;return this.elements[0]=Math.cos(e),this.elements[1]=Math.sin(e),this.elements[4]=-Math.sin(e),this.elements[5]=Math.cos(e),this},t.prototype.multiply=function(t){for(var e=new Array(16).fill(0),r=0;r<4;++r)for(var n=0;n<4;++n){for(var i=0,o=0;o<4;++o)i+=this.elements[n+4*o]*t.elements[o+4*r];e[n+4*r]=i}return this.elements=new Float32Array(e),this},t.prototype.orthographic=function(t,e,r,n,i,o){return this.elements[0]=2/(e-t),this.elements[5]=2/(n-r),this.elements[10]=2/(i-o),this.elements[12]=(e+t)/(t-e),this.elements[13]=(r+n)/(r-n),this.elements[14]=(o+i)/(o-i),this},t}();e.float4x4=i},function(t,e,r){"use strict";e.__esModule=!0;var n=r(0),i=function(){function t(t,e){this.locationHashMap={},this.vsId=this.createShader(n.GL.VERTEX_SHADER,t),this.fsId=this.createShader(n.GL.FRAGMENT_SHADER,e),this.compileShader(this.vsId)&&this.compileShader(this.fsId)&&this.createProgram()}return t.prototype.enable=function(){n.GL.useProgram(this.program)},t.prototype.disable=function(){n.GL.useProgram(null)},t.prototype.setUniform1i=function(t,e){var r=this.getLocation(t);null!==r?(this.enable(),n.GL.uniform1i(r,e)):console.error("SET UNIFORM INT ERROR: "+t+" not found!")},t.prototype.setUniform1f=function(t,e){var r=this.getLocation(t);null!==r?(this.enable(),n.GL.uniform1f(r,e)):console.error("SET UNIFORM FLOAT ERROR: "+t+" not found!")},t.prototype.setUniformMatrix4f=function(t,e){var r=this.getLocation(t);null!==r?(this.enable(),n.GL.uniformMatrix4fv(r,!1,e.elements)):console.error("SET UNIFORM MATRIX4 FLOAT ERROR: "+t+" not found!")},t.prototype.setUniform2f=function(t,e,r){var i=this.getLocation(t);null!==i?(this.enable(),n.GL.uniform2f(i,e,r)):console.error("SET UNIFORM FLOAT2 ERROR: "+t+" not found!")},t.prototype.createProgram=function(){this.program=n.GL.createProgram(),n.GL.attachShader(this.program,this.vsId),n.GL.attachShader(this.program,this.fsId),n.GL.linkProgram(this.program),n.GL.deleteShader(this.vsId),n.GL.deleteShader(this.fsId)},t.prototype.createShader=function(t,e){var r=document.getElementById(e).innerHTML,i=n.GL.createShader(t);return n.GL.shaderSource(i,r),i},t.prototype.compileShader=function(t){return n.GL.compileShader(t),!!n.GL.getShaderParameter(t,n.GL.COMPILE_STATUS)||(console.log("SHADER COMPILE ERROR: "+n.GL.getShaderInfoLog(t)),!1)},t.prototype.getLocation=function(t){if(t in this.locationHashMap)return this.locationHashMap[t];var e=n.GL.getUniformLocation(this.program,t);return null!==e?(this.locationHashMap[t]=e,e):null},t}();e.Shader=i},function(t,e,r){"use strict";e.__esModule=!0;var n=r(0),i=function(){function t(t,e,r){this.count=e.length,this.VAO=n.GL.createVertexArray(),n.GL.bindVertexArray(this.VAO),this.VBO=n.GL.createBuffer(),n.GL.bindBuffer(n.GL.ARRAY_BUFFER,this.VBO),n.GL.bufferData(n.GL.ARRAY_BUFFER,t,n.GL.STATIC_DRAW),n.GL.vertexAttribPointer(0,3,n.GL.FLOAT,!1,0,0),n.GL.enableVertexAttribArray(0),this.TBO=n.GL.createBuffer(),n.GL.bindBuffer(n.GL.ARRAY_BUFFER,this.TBO),n.GL.bufferData(n.GL.ARRAY_BUFFER,r,n.GL.STATIC_DRAW),n.GL.vertexAttribPointer(1,2,n.GL.FLOAT,!1,0,0),n.GL.enableVertexAttribArray(1),this.IBO=n.GL.createBuffer(),n.GL.bindBuffer(n.GL.ELEMENT_ARRAY_BUFFER,this.IBO),n.GL.bufferData(n.GL.ELEMENT_ARRAY_BUFFER,e,n.GL.STATIC_DRAW),this.unbind()}return t.prototype.bind=function(){n.GL.bindVertexArray(this.VAO),n.GL.bindBuffer(n.GL.ARRAY_BUFFER,this.VBO),n.GL.bindBuffer(n.GL.ELEMENT_ARRAY_BUFFER,this.IBO)},t.prototype.unbind=function(){n.GL.bindVertexArray(null),n.GL.bindBuffer(n.GL.ARRAY_BUFFER,null),n.GL.bindBuffer(n.GL.ELEMENT_ARRAY_BUFFER,null)},t.prototype.render=function(){this.bind(),this.draw()},t.prototype.draw=function(){n.GL.drawElements(n.GL.TRIANGLES,this.count,n.GL.UNSIGNED_BYTE,0)},t}();e.VertexArray=i},function(t,e,r){"use strict";e.__esModule=!0;var n=r(0),i=function(){function t(t){this.image=new Image,this.texture=n.GL.createTexture(),this.image.src=t}return t.prototype.create=function(){var t=this;return new Promise(function(e){t.image.addEventListener("load",function(){n.GL.bindTexture(n.GL.TEXTURE_2D,t.texture),n.GL.texParameteri(n.GL.TEXTURE_2D,n.GL.TEXTURE_MIN_FILTER,n.GL.NEAREST),n.GL.texParameteri(n.GL.TEXTURE_2D,n.GL.TEXTURE_MAG_FILTER,n.GL.NEAREST),n.GL.texImage2D(n.GL.TEXTURE_2D,0,n.GL.RGBA,n.GL.RGBA,n.GL.UNSIGNED_BYTE,t.image),e()})})},t.prototype.bind=function(){n.GL.bindTexture(n.GL.TEXTURE_2D,this.texture)},t.prototype.unbind=function(){n.GL.bindTexture(n.GL.TEXTURE_2D,null)},t}();e.Texture=i},function(t,e,r){"use strict";e.__esModule=!0;var n=r(3),i=r(4),o=function(){function t(){}return t.create=function(){var t=new Float32Array([-10,-5.625,0,-10,5.625,0,0,5.625,0,0,-5.625,0]),e=new Uint8Array([0,1,2,2,3,0]),r=new Float32Array([0,1,0,0,1,0,1,1]);return this.mesh=new n.VertexArray(t,e,r),this.texture=new i.Texture("res/background.jpg"),this.texture.create()},t}();e.Background=o},function(t,e,r){"use strict";e.__esModule=!0;var n=r(3),i=r(4),o=r(1),a=r(2),s=r(7),u=function(){function t(){this.position=new o.float3,this.gravity=0,this.rotationAngle=0}return t.create=function(){var t=new Float32Array([-.5,-.5,.2,-.5,.5,.2,.5,.5,.2,.5,-.5,.2]),e=new Uint8Array([0,1,2,2,3,0]),r=new Float32Array([0,1,0,0,1,0,1,1]);return this.mesh=new n.VertexArray(t,e,r),this.texture=new i.Texture("res/bird.png"),this.texture.create()},t.prototype.getPositionY=function(){return this.position.y},t.prototype.update=function(){this.position.y-=this.gravity,s.Input.isKeyDown("Space")?this.gravity=-.1:this.gravity+=.01,this.rotationAngle=100*-this.gravity},t.prototype.updateGravity=function(){},t.prototype.render=function(){var e=(new o.float4x4).translate(this.position),r=(new o.float4x4).rotate(this.rotationAngle);a.Shader.bird.enable(),a.Shader.bird.setUniformMatrix4f("u_modelMatrix",e.multiply(r)),t.texture.bind(),t.mesh.render(),a.Shader.bird.disable()},t}();e.Bird=u},function(t,e,r){"use strict";e.__esModule=!0;var n=function(){function t(){}return t.init=function(){var t=this;document.addEventListener("keydown",function(e){t.keyDownHashMap[e.code]=!0}),document.addEventListener("keyup",function(e){t.keyDownHashMap[e.code]=!1})},t.isKeyDown=function(t){return!!this.keyDownHashMap[t]},t.keyDownHashMap={},t}();e.Input=n},function(t,e,r){"use strict";e.__esModule=!0;var n=r(3),i=r(4),o=r(1),a=r(0);e.BARRIER_GAP=a.DISPLAY_HEIGHT/100*2*30;var s=function(){function t(t,e){this.position=new o.float3(t,e),this.u_modelMatrix=(new o.float4x4).translate(this.position)}return t.create=function(){var t=new Float32Array([0,0,.1,0,this.height,.1,this.width,this.height,.1,this.width,0,.1]),e=new Uint8Array([0,1,2,2,3,0]),r=new Float32Array([0,1,0,0,1,0,1,1]);return this.mesh=new n.VertexArray(t,e,r),this.texture=new i.Texture("res/pipe.png"),this.texture.create()},t.getHeight=function(){return this.height},t.getWidth=function(){return this.width},t.render=function(){},t.prototype.getModelMatrix=function(){return this.u_modelMatrix},t.prototype.getX=function(){return this.position.x},t.prototype.getY=function(){return this.position.y},t.height=2*a.DISPLAY_HEIGHT-e.BARRIER_GAP,t.width=1.5,t}();e.Barrier=s},function(t,e,r){"use strict";e.__esModule=!0;var n=r(10),i=r(0);!function(){if(i.initWebGL(),null!==i.GL){console.log(i.GL);var t=new n.Game;t.init().then(function(){t.run()})}else console.log("WebGL context not found!")}()},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,s)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};e.__esModule=!0;var o=r(2),a=r(5),s=r(0),u=r(1),h=r(6),c=r(11),f=r(7),d=r(8),l=function(){function t(){this.gameObjectsArray=[h.Bird,a.Background,d.Barrier],this.count=0}return t.prototype.init=function(){return s.GL.enable(s.GL.DEPTH_TEST),s.GL.activeTexture(s.GL.TEXTURE0),this.loadShaders(),this.setUniforms(),f.Input.init(),this.scene=new c.Scene,this.loadObjects()},t.prototype.run=function(){this.scene.isEndGame||(this.count++,this.render(),this.update(),requestAnimationFrame(this.run.bind(this)))},t.prototype.loadShaders=function(){o.Shader.background=new o.Shader("backgroundVS","backgroundFS"),o.Shader.bird=new o.Shader("birdVS","birdFS"),o.Shader.barrier=new o.Shader("barrierVS","barrierFS")},t.prototype.loadObjects=function(){return n(this,void 0,void 0,function(){var t=this;return i(this,function(e){return[2,new Promise(function(e){var r=t.gameObjectsArray.length;t.gameObjectsArray.forEach(function(t){t.create().then(function(){--r||e()})})})]})})},t.prototype.setUniforms=function(){var t=new u.float4x4;t.orthographic(-s.DISPLAY_WIDTH,s.DISPLAY_WIDTH,-s.DISPLAY_HEIGHT,s.DISPLAY_HEIGHT,-1,1),o.Shader.background.setUniformMatrix4f("u_projectionMatrix",t),o.Shader.background.setUniform1i("u_tex",0),o.Shader.bird.setUniformMatrix4f("u_projectionMatrix",t),o.Shader.bird.setUniform1i("u_tex",0),o.Shader.barrier.setUniformMatrix4f("u_projectionMatrix",t),o.Shader.barrier.setUniform1i("u_tex",0)},t.prototype.update=function(){this.scene.update()},t.prototype.render=function(){s.GL.clear(s.GL.COLOR_BUFFER_BIT|s.GL.DEPTH_BUFFER_BIT),this.scene.render();var t=s.GL.getError();t!=s.GL.NO_ERROR&&console.error(t)},t}();e.Game=l},function(t,e,r){"use strict";e.__esModule=!0;var n=r(6),i=r(2),o=r(5),a=r(1),s=r(8),u=r(0),h=function(){function t(){this.barriers=[],this.barrierOffset=5,this.currentBarrierIndex=0,this.time=0,this.XOffset=0,this.bgXOffset=0,this.isEndGame=!1,this.bird=new n.Bird,this.createBarriers()}return t.prototype.update=function(){this.XOffset-=2,this.XOffset%Math.ceil(u.DISPLAY_WIDTH/.03)==0&&this.bgXOffset++,-this.XOffset>250&&-this.XOffset%120==0&&this.updateBarriers(),this.collisionDetection()&&this.endGame(),this.bird.update(),this.time+=.01},t.prototype.render=function(){this.renderBackground(),this.renderBird(),this.renderBarriers()},t.prototype.renderBackground=function(){i.Shader.background.enable(),o.Background.texture.bind();for(var t=this.bgXOffset;t<this.bgXOffset+4;++t)i.Shader.background.setUniformMatrix4f("u_viewMatrix",(new a.float4x4).translate(new a.float3(10*t+.03*this.XOffset,0,0))),o.Background.mesh.render();i.Shader.background.disable(),o.Background.texture.unbind()},t.prototype.renderBird=function(){this.bird.render()},t.prototype.renderBarriers=function(){i.Shader.barrier.enable(),i.Shader.barrier.setUniformMatrix4f("u_viewMatrix",(new a.float4x4).translate(new a.float3(.05*this.XOffset,0,0))),s.Barrier.texture.bind(),s.Barrier.mesh.bind();for(var t=0;t<10;++t)i.Shader.barrier.setUniformMatrix4f("u_modelMatrix",this.barriers[t].getModelMatrix()),i.Shader.barrier.setUniform1i("u_top",t%2==0?1:0),s.Barrier.mesh.draw();s.Barrier.mesh.unbind(),s.Barrier.texture.unbind()},t.prototype.createBarriers=function(){for(var t=0;t<10;t+=2){var e=this.barrierOffset+3*this.currentBarrierIndex,r=Math.random()*u.DISPLAY_HEIGHT;this.barriers.push(new s.Barrier(e,r)),this.barriers.push(new s.Barrier(e,r-2*u.DISPLAY_HEIGHT)),this.currentBarrierIndex+=2}},t.prototype.updateBarriers=function(){var t=this.barrierOffset+3*this.currentBarrierIndex,e=Math.random()*u.DISPLAY_HEIGHT;this.barriers[this.currentBarrierIndex++%10]=new s.Barrier(t,e),this.barriers[this.currentBarrierIndex++%10]=new s.Barrier(t,e-2*u.DISPLAY_HEIGHT)},t.prototype.collisionDetection=function(){for(var t=.05*-this.XOffset,e=this.bird.getPositionY(),r=0;r<10;r+=2){var n=this.barriers[r].getX(),i=this.barriers[r].getY(),o=t>=n&&t<=n+s.Barrier.getWidth(),a=e<i-s.BARRIER_GAP||e>i;if(o&&a)return!0}},t.prototype.endGame=function(){this.isEndGame=!0,document.querySelector(".game-over").classList.add("show")},t}();e.Scene=h}]);